import{i as C,A as i,_ as T,j as D,w as S,u as A,b as v,P as d,c as s,a as e,x as B,t as r,f as h,F as k,r as x,m as L,n as N,v as P,y as V,z as g,o,p as j,g as G}from"./index.8f14c019.js";import{C as z,a as y}from"./AttendeesService.b6fb4367.js";import{e as E}from"./EventsService.bf87e9c3.js";class F{async createComment(a){const m=await C.post("api/comments",a);i.comments.push(new z(m.data))}async deleteComment(a){await C.delete("api/comments/"+a);let m=i.comments.findIndex(t=>t.id==a);i.comments.splice(m,1)}}const I=new F;const M={setup(){const l=V(),a=l.params.eventId,m=D({});async function t(){try{await E.getEventById(a)}catch(n){d.error(n.message,"Getting Event By Id")}}async function u(){try{await y.getEventTickets(a)}catch(n){d.error(n.message,"Getting Event Tickets")}}async function b(){try{await y.getEventComments(a)}catch(n){d.error(n.message,"Getting Event Comments")}}return S(()=>{l.params.eventId&&(t(),u(),b())}),A(()=>{i.event=null}),{editable:m,attending:v(()=>!!i.eventTickets.find(n=>n.profile.id==i.account.id)),event:v(()=>i.event),account:v(()=>i.account),eventTickets:v(()=>i.eventTickets),comments:v(()=>i.comments),async attendEvent(){try{await y.attendEvent({eventId:l.params.eventId})}catch(n){d.error(n.message,"Attending Event")}},async createComment(){try{const n=m.value;n.eventId=a,await I.createComment(n),m.value={}}catch(n){d.error(n.message,"Creating Comment")}},async cancelEvent(){try{await d.confirm("Are you sure you wish to cancel this event?","This action can not be reversed.","Yep!")&&await E.cancelEvent(a)}catch(n){d.error(n.message,"Cancelling Event")}},async deleteComment(n){try{await d.confirm("Are you sure you want to delete your comment?")&&await I.deleteComment(n)}catch(_){d.error(_.message,"Deleting Comment")}}}}},f=l=>(j("data-v-fcf464ec"),l=l(),G(),l),U={key:0,class:"container-fluid mt-1"},H={class:"row"},R={class:"col-12 px-4"},Y={class:"col-12 fixme"},q={class:"icy row py-3 px-4"},J={class:"col-4 d-flex align-items-center thumbnailCol"},K=["src","alt"],O={class:"col-8 d-flex flex-column justify-content-between h-100"},Q={class:"row"},W={class:"col-6 d-flex flex-column"},X={class:"fs-5 fw-bold"},Z={class:"col-6 d-flex justify-content-end"},$={class:"col-12 mt-4",id:"eventDescription"},ee={class:"row"},te={class:"col-12 d-flex justify-content-between align-items-center"},ne={key:0},se={key:0},oe={class:"green"},ae=g(" spots left."),ce={key:1},ie={class:"red"},le=g(" spots left."),de={key:1,class:"d-flex align-items-center"},re=f(()=>e("span",{class:"fs-5 red fw-bold"},"EVENT CANCELLED",-1)),me=[re],ve={key:2},_e=f(()=>e("span",{class:"fw-bold"},"Event Host:",-1)),he=["src","alt","title"],fe={key:3},ye={key:1,class:"btn btn-danger",disabled:""},ge={key:2,class:"btn btn-grey",disabled:""},ue={key:4},be={key:5},pe={class:"col-12 px-3 mt-4"},we={class:"w-100 bg-dark bg-gradient py-2 px-1"},Ce=f(()=>e("div",null,[e("span",{class:"my-shadow"},"Attending This Event:")],-1)),ke=["src","alt","title"],xe={class:"col-8 offset-2 mt-5 py-3 bg-dark mb-3"},Ee={class:"row px-4"},Ie={class:"col-12 mb-1"},Te={key:0,class:"btn btn-success bg-gradient elevation-1 mt-2"},De={key:1,class:"btn btn-outline-light mt-2",disabled:""},Se={class:"row mt-3 px-4"},Ae={class:"col-2 text-center"},Be=["src","alt"],Le={class:"col-10 d-flex align-items-center"},Ne={class:"w-100 bg-grey rounded d-flex flex-column p-2"},Pe={key:0,class:""},Ve=g(" - "),je=f(()=>e("i",null,"Attending This Event",-1)),Ge={key:1,class:""},ze={class:"mt-1"},Fe=["onClick"];function Me(l,a,m,t,u,b){var n,_;return t.event?(o(),s("div",U,[e("div",H,[e("div",R,[e("div",{class:"row eventDetailsCard text-light my-shadow elevation-1",style:B({backgroundImage:`url(${t.event.coverImg})`})},[e("div",Y,[e("div",q,[e("div",J,[e("img",{src:t.event.coverImg,alt:t.event.name,id:"eventThumbnail",class:"elevation-2"},null,8,K)]),e("div",O,[e("div",Q,[e("div",W,[e("span",X,[e("b",null,r(t.event.name),1)]),e("span",null,r(t.event.location),1)]),e("div",Z,[e("span",null,r(new Date(t.event.startDate).toLocaleDateString()),1)]),e("div",$,[e("span",null,r(t.event.description),1)])]),e("div",ee,[e("div",te,[t.event.isCanceled==!1?(o(),s("div",ne,[t.event.capacity>0?(o(),s("span",se,[e("span",oe,r(t.event.capacity),1),ae])):(o(),s("span",ce,[e("span",ie,r(t.event.capacity),1),le]))])):(o(),s("div",de,me)),t.event.isCanceled==!1?(o(),s("div",ve,[_e,e("img",{src:t.event.creator.picture,alt:t.event.creator.name,title:t.event.creator.name,class:"rounded-circle border border-dark border-2 ms-3",height:"75",width:"75"},null,8,he)])):h("",!0),t.event.isCanceled==!1&&t.account.id?(o(),s("div",fe,[t.event.capacity>0&&t.attending==!1?(o(),s("button",{key:0,class:"btn btn-warning elevation-1",type:"button",onClick:a[0]||(a[0]=c=>t.attendEvent())},"Attend Event")):t.event.capacity==0?(o(),s("button",ye,"No Spots Left!")):(o(),s("button",ge,"Already Attending"))])):h("",!0),((n=t.event.creator)==null?void 0:n.id)==((_=t.account)==null?void 0:_.id)&&t.event.isCanceled==!1?(o(),s("div",ue,[e("button",{class:"btn btn-danger",onClick:a[1]||(a[1]=c=>t.cancelEvent())},"Cancel Event")])):(o(),s("div",be))])])])])])],4)]),e("div",pe,[e("div",we,[Ce,e("div",null,[(o(!0),s(k,null,x(t.eventTickets,c=>(o(),s("img",{src:c.profile.picture,alt:c.profile.name,title:c.profile.name,height:"40",width:"40",class:"rounded-circle ms-1 border-black elevation-1"},null,8,ke))),256))])])]),e("div",xe,[e("div",Ee,[e("div",Ie,[e("form",{class:"d-flex flex-column align-items-end",onSubmit:a[3]||(a[3]=L(c=>t.createComment(),["prevent"]))},[N(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=c=>t.editable.body=c),id:"commentBody",placeholder:"Tell the people..."},null,512),[[P,t.editable.body]]),t.account.id?(o(),s("button",Te,"Post Comment")):(o(),s("button",De,"Log-In to Comment"))],32)])]),(o(!0),s(k,null,x(t.comments,c=>{var p;return o(),s("div",Se,[e("div",Ae,[e("img",{class:"rounded-circle elevation-1",src:c.creator.picture,alt:c.creator.name,height:"80",width:"80"},null,8,Be)]),e("div",Le,[e("div",Ne,[t.eventTickets.find(w=>w.profile.id==c.creator.id)?(o(),s("span",Pe,[e("b",null,r(c.creator.name),1),Ve,je])):(o(),s("span",Ge,[e("b",null,r(c.creator.name),1)])),e("span",ze,r(c.body),1),c.creator.id==((p=t.account)==null?void 0:p.id)?(o(),s("button",{key:2,type:"button",onClick:w=>t.deleteComment(c.id),class:"btn btn-danger mt-2 w-25"},"Delete Comment",8,Fe)):h("",!0)])])])}),256))])])])):h("",!0)}const Ye=T(M,[["render",Me],["__scopeId","data-v-fcf464ec"]]);export{Ye as default};
